### Motion Matching 的方法

#### 介绍
[参考](https://zhuanlan.zhihu.com/p/50141261)

起源：Motion Fields，大致思路是根据玩家反馈和当前帧状态搜索动画数据库中最佳匹配的帧或者动画片段，进行合成。
首次提出motion matching，荣耀战魂（UBI）

如何找到与当前动画最匹配的动画数据？
通过对比当前动画与动画数据库中的动画数据的 轨迹，Pose, 速度.

- 轨迹：
首先根据玩家当前的操作输入，结合当前角色运动的**速度，加速度**，可以预判t时间后的角色的**位置**。
随后遍历动画库中每条动画，第0帧开始，逐次对比t秒后的角色位置, 与预判的角色位置做比较，并记录位置间的距离和root朝向。

- Pose
其次，对比当前角色骨骼和片段A的第0帧的角色各骨骼位置，并记录距离的差值。

- 速度
然后对比各个骨骼点的速度，并记录速度的差值。

综合以上规律，搜索到的差越小则表示当前动画帧与搜索出的帧越相近。但是，并不是所有维度都重要，比如位置和骨骼的重要性，不同骨骼之间的差异性等。这时候就需要
分配权重。

动画数据库的建立

因为需要搜索大量的动画帧，因此动画数据库中的动作的丰富度应当尽量大。

UBI分享了他们制作时的经验：Dance Card就像是动捕中的单词卡，能够尽量的汇总这些单词，从而组织出动画的语言。

在实际中动画不需要零碎，数据库中的动画都是大段的。

[UNITY的一个实现上述的思路](https://github.com/nashnie/MotionMatching)
[UNreal中的一个实现](https://github.com/Hethger/UE4_MotionMatching-)


